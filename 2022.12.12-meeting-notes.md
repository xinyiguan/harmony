# 2022.12.12 Meeting notes

## Chord Transitions heatmaps


### 1. How data is extracted: 
- Piece-wise operation: extract chord transitions (bigrams) within the same local key segment in a piece (referencing the same local tonic), 
and according to the mode (major or minor) which the bigrams are in.
- Perform the piece-wise operation for all annotated pieces in the small DCML corpus.

#### Questions in extracting the chord bigrams:
![Screenshot 2022-12-12 at 10 28 56](https://user-images.githubusercontent.com/43217135/207010213-0bf1d122-9199-472b-9898-6daeaee04a87.png)


**Q1**: In the tsv file the highlighted region corresponds to the sequence `V I _ I6 V(64)` (in the key of Bb). How do we treat this "gap" when extracting bigrams?
    
- **option 1:** (current implementation): discard the gap 
     - `(V, I) (I, I6) (I6, V(64))`

- **option 2:** fill in the `I` chord.
     - `(V, I) (I, I) (I, I6) (I6, V(64))`

- **option 3:** fill in `n/a`, probably not a good idea?
     - `(V, I) (I, n/a) (n/a, I6) (I6, V(64))`

**Q2:** In the "chord" column in the tsv file, sometimes there seems to have consecutive chords that are repeating (same annotated chords, see fig below)? Do we want the `(I,I)` or `(V,V)` etc., in the bigram (given they refer to the same tonic)? 
Should I change the current implementation option 1 in Q1 to option 2 to make it consistent?

- beethoven case: at repeat end, need to consider the measure number (end repeat sign). Side question: do we consider bigrams the repeat section?
- grieg case: around the phrase mark
![Screenshot 2022-12-12 at 11 15 16](https://user-images.githubusercontent.com/43217135/207026267-8daa7d19-4c90-4998-b66c-7da88b1616c2.png)
![Screenshot 2022-12-12 at 11 16 50](https://user-images.githubusercontent.com/43217135/207026271-688e9067-2f3d-4c64-83ec-c56941b7afe2.png)




---

### 2. Plots and Interpretations:
- Look at the most frequent chord transitions (top 30).


#### 2.1 Metacorpora level:
![](https://i.imgur.com/h1kCaOt.png)

The figure shows the transition probabilities between the 30 top ranking chords across the entire corpus (containing 17 DCML corpora) in major segments (on the top) and in minor segments (at the bottom), where the transition probability (the conditional probability) is defined as:

$p_{a,b}=p_{a\rightarrow b}=P(chord_i=b|chord_{i-1}=a)$


- The shape values tells us about the size of chord vocabularies.


#### 2.2 Group by era:

![](https://i.imgur.com/XUJVICJ.jpg)


The figure shows the transition probabilities between the 30 top ranking chords in different era. Note that the rankings of chords are different in different era. 






### 3. Other related thoughts:

- **[study of pivot chord]** we can also look at the chord transition between the local key segements to study how modulation is done. 


---
## TODOs:


